---
layout: post
title: web常见漏洞——密码找回漏洞攻击和防御
date: 2023-10-10 00:00:00 +0800
category: web
thumbnail: /style/image/thumbnail3.png
icon: code
---


* content
{:toc}

# 前言

为了防止用户遗忘密码，大多数网站都提供了找回密码功能。常见的找回密码方式有：邮箱找回密码、根据密码保护问题找回密码、根据手机号码找回密码等。虽然这些方式都可以找回密码，但实现方式各不相同。无论是哪种密码找回方式，在找回密码时，除了自己的用户密码，如果还能找回其他用户的密码，就存在密码找回漏洞。

## 密码找回漏洞靶场

以月师傅ubuntu靶场为例：

![密码找回漏洞](/style/image/image21.png)

## 密码找回漏洞源码分析
```

```


## 密码找回漏洞攻击

+ BP抓包：


+ 测试查看后台验证码：


+ 穷举攻击：

## 防御
1. 验证码爆破的，从验证码有效期和请求次数进行限制；

2. token 验证之类的，不要直接返回给用户；

3. 修改加密算法和加密内容，一定要是强加密，也要做到增加猜解难度或密文不可猜解；

4. 用户身份验证一定要在后端实现；

5. 在最后一步修改密码的动作时，一定要校验帐号是否通过了验证、短信与手机号是否对应、发送短信与已校验帐号不要使用同一个 session 名称；

6. 非常重要的一点：上线前一定要经过安全测试！！

3.	在一段时间内的次数进行限定，超过无效。
## Reference
[网络安全渗透测试—[常规漏洞挖掘与利用篇16]—[密码找回漏洞与测试]](https://blog.csdn.net/qq_45555226/article/details/122792043?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169687209616800186565049%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=169687209616800186565049&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-122792043-null-null.nonecase&utm_term=%E5%AF%86%E7%A0%81%E6%89%BE%E5%9B%9E&spm=1018.2226.3001.4450)
